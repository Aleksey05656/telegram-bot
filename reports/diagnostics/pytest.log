........................................................................................................................ [ 68%]
............F.........................................                                                                   [100%]
=========================================================== FAILURES ===========================================================
___________________________________________________ test_run_simulation_cli ____________________________________________________

tmp_path = PosixPath('/tmp/pytest-of-root/pytest-1/test_run_simulation_cli0')

    @pytest.mark.needs_np
    def test_run_simulation_cli(tmp_path: Path):
        db = tmp_path / "preds.sqlite"
        report = tmp_path / "report.md"
        env = {"DB_PATH": str(db)}
        cmd = [
            "python",
            "scripts/run_simulation.py",
            "--season-id",
            "default",
            "--home",
            "H",
            "--away",
            "A",
            "--rho",
            "0.1",
            "--n-sims",
            "512",
            "--calibrate",
            "--write-db",
            "--report-md",
            str(report),
        ]
        subprocess.run(cmd, check=True, env={**env, **os.environ})
        assert report.exists()
        conn = sqlite3.connect(db)
>       cur = conn.execute("SELECT COUNT(*) FROM predictions")
E       sqlite3.OperationalError: no such table: predictions

tests/smoke/test_run_simulation_cli.py:41: OperationalError
----------------------------------------------------- Captured stdout call -----------------------------------------------------
{"1x2": {"1": 0.33203125, "x": 0.296875, "2": 0.37109375}, "btts": {"yes": 0.53515625, "no": 0.46484375}, "totals": {"0.5": {"over": 0.908203125, "under": 0.091796875}, "1.5": {"over": 0.72265625, "under": 0.27734375}, "2.5": {"over": 0.462890625, "under": 0.537109375}, "3.5": {"over": 0.263671875, "under": 0.736328125}, "4.5": {"over": 0.109375, "under": 0.890625}, "5.5": {"over": 0.046875, "under": 0.953125}}, "cs": {"0:0": 0.091796875, "0:1": 0.109375, "0:2": 0.0703125, "0:3": 0.02734375, "0:4": 0.013671875, "0:5": 0.0, "0:6": 0.0, "1:0": 0.076171875, "1:1": 0.142578125, "1:2": 0.078125, "1:3": 0.021484375, "1:4": 0.0078125, "1:5": 0.001953125, "1:6": 0.0, "2:0": 0.046875, "2:1": 0.0703125, "2:2": 0.05078125, "2:3": 0.021484375, "2:4": 0.009765625, "2:5": 0.001953125, "2:6": 0.0, "3:0": 0.0234375, "3:1": 0.0625, "3:2": 0.02734375, "3:3": 0.01171875, "3:4": 0.005859375, "3:5": 0.001953125, "3:6": 0.0, "4:0": 0.005859375, "4:1": 0.005859375, "4:2": 0.001953125, "4:3": 0.001953125, "4:4": 0.0, "4:5": 0.0, "4:6": 0.0, "5:0": 0.0, "5:1": 0.0, "5:2": 0.001953125, "5:3": 0.0, "5:4": 0.0, "5:5": 0.0, "5:6": 0.0, "6:0": 0.0, "6:1": 0.005859375, "6:2": 0.0, "6:3": 0.0, "6:4": 0.0, "6:5": 0.0, "6:6": 0.0, "OTHER": 0.001953125}, "entropy": {"1x2": 1.5789960805279017, "totals": 0.9960228568316534, "cs": 4.075876716866467}}
=================================================== short test summary info ====================================================
SKIPPED [1] tests/ml/test_prediction_invariants.py:14: could not import 'hypothesis': No module named 'hypothesis'
FAILED tests/smoke/test_run_simulation_cli.py::test_run_simulation_cli - sqlite3.OperationalError: no such table: predictions

