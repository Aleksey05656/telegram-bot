# @file: patches/002-precommit-ci.patch
# @description: Pin pre-commit hook revisions and add CI workflow with pip cache
# @dependencies: .pre-commit-config.yaml, .github/workflows/ci.yml
# @created: 2025-09-10

diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index d005644..e65bece 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -1,5 +1,5 @@
 # @file: .github/workflows/ci.yml
-# @description: CI workflow running linting and tests
+# @description: CI workflow running linting and tests across Python versions with pip cache
 # @dependencies: .pre-commit-config.yaml, requirements.txt
 # @created: 2025-08-24
 
@@ -7,26 +7,32 @@ name: CI
 
 on:
   push:
-    branches: [ main ]
+    branches: [ main, master ]
   pull_request:
-    branches: [ main ]
+    branches: [ main, master ]
 
 jobs:
-  build:
+  build-test:
     runs-on: ubuntu-latest
-
+    strategy:
+      matrix:
+        python-version: ["3.10", "3.11"]
     steps:
-      - uses: actions/checkout@v3
+      - uses: actions/checkout@v4
       - name: Set up Python
-        uses: actions/setup-python@v4
+        uses: actions/setup-python@v5
         with:
-          python-version: '3.11'
-      - name: Install dependencies
+          python-version: ${{ matrix.python-version }}
+          cache: "pip"
+      - name: Install deps
+        run: |
+          python -m pip install -U pip
+          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
+      - name: Install pre-commit hooks
         run: |
-          python -m pip install --upgrade pip
-          pip install -r requirements.txt
           pip install pre-commit
-      - name: Run pre-commit
+          pre-commit install-hooks
+      - name: Lint
         run: pre-commit run --all-files
-      - name: Run tests
-        run: pytest
+      - name: Test
+        run: pytest -q
diff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml
index 941d4dd..4e34996 100644
--- a/.pre-commit-config.yaml
+++ b/.pre-commit-config.yaml
@@ -1,19 +1,35 @@
 # @file: .pre-commit-config.yaml
-# @description: pre-commit hooks configuration with Black, Ruff and mypy
+# @description: pre-commit hooks configuration with pinned revisions and basic checks
 # @dependencies: requirements.txt
 # @created: 2025-08-24
 
 repos:
+  # при необходимости укажите ваш зеркальный репозиторий:
+  # - repo: https://gitea.corp.local/mirrors/psf/black
   - repo: https://github.com/psf/black
-    rev: 23.7.0
+    rev: 24.3.0
     hooks:
       - id: black
   - repo: https://github.com/astral-sh/ruff-pre-commit
-    rev: v0.0.272
+    rev: v0.6.5
     hooks:
       - id: ruff
+        args: ["--fix"]
+  - repo: https://github.com/pre-commit/mirrors-isort
+    rev: v5.13.2
+    hooks:
+      - id: isort
+  - repo: https://github.com/pre-commit/pre-commit-hooks
+    rev: v4.6.0
+    hooks:
+      - id: end-of-file-fixer
+      - id: trailing-whitespace
+      - id: check-yaml
   - repo: https://github.com/pre-commit/mirrors-mypy
     rev: v1.4.1
     hooks:
       - id: mypy
         additional_dependencies: [types-requests]
+
+default_language_version:
+  python: python3
