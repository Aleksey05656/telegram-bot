# @file: .env.example
# @description: Example environment variables
# @dependencies: app/config.py
# @created: 2025-09-10

APP_NAME=ml-service
DEBUG=false
ENV=local
LOG_LEVEL=INFO
APP_VERSION=1.0.0-rc1
GIT_SHA=dev  # в CI подменяется
TELEGRAM_BOT_TOKEN=""
SPORTMONKS_API_KEY=""
SPORTMONKS_API_TOKEN=""
SPORTMONKS_BASE_URL=https://api.sportmonks.com/v3/football
SPORTMONKS_TIMEOUT_SEC=10
SPORTMONKS_RETRY_ATTEMPTS=4
SPORTMONKS_BACKOFF_BASE=0.5
SPORTMONKS_RPS_LIMIT=3
SPORTMONKS_DEFAULT_TIMEWINDOW_DAYS=7
SPORTMONKS_LEAGUES_ALLOWLIST=EPL,LaLiga,SerieA
# TTL>0 включает кеширование ETag/Last-Modified в SQLite и условные GET-запросы
SPORTMONKS_CACHE_TTL_SEC=900

# Включение заглушки SportMonks (автоматически включается если ключ пустой или dummy)
SPORTMONKS_STUB=1
ODDS_API_KEY=""
ODDS_PROVIDERS=csv
ODDS_PROVIDER_WEIGHTS=csv:1.0
ODDS_PROVIDER=dummy
ODDS_AGG_METHOD=median
ODDS_SNAPSHOT_RETENTION_DAYS=14
ODDS_REFRESH_SEC=300
ODDS_RPS_LIMIT=3
ODDS_TIMEOUT_SEC=8
ODDS_RETRY_ATTEMPTS=4
ODDS_BACKOFF_BASE=0.4
ODDS_OVERROUND_METHOD=proportional
VALUE_MIN_EDGE_PCT=3.0
VALUE_MIN_CONFIDENCE=0.6
VALUE_MAX_PICKS=5
VALUE_MARKETS=1X2,OU_2_5,BTTS
VALUE_CONFIDENCE_METHOD=mc_var
VALUE_ALERT_COOLDOWN_MIN=60
VALUE_ALERT_QUIET_HOURS=23:00-08:00
VALUE_ALERT_MIN_EDGE_DELTA=0.7
VALUE_ALERT_UPDATE_DELTA=1.5
VALUE_ALERT_MAX_UPDATES=3
VALUE_STALENESS_FAIL_MIN=30
CLV_WINDOW_BEFORE_KICKOFF_MIN=120
CLV_FAIL_THRESHOLD_PCT=-5.0
BACKTEST_DAYS=120
BACKTEST_MIN_SAMPLES=300
BACKTEST_OPTIM_TARGET=sharpe
BACKTEST_VALIDATION=time_kfold
GATES_VALUE_SHARPE_WARN=0.1
GATES_VALUE_SHARPE_FAIL=0.0
ENABLE_VALUE_FEATURES=0
DATABASE_URL=postgresql+asyncpg://user:pass@postgres:5432/sports
DATA_ROOT=/data
DB_PATH=/data/bot.sqlite3
REPORTS_DIR=/data/reports
MODEL_REGISTRY_PATH=/data/artifacts
LOG_DIR=/data/logs
RUNTIME_LOCK_PATH=/data/runtime.lock
BACKUP_DIR=/data/backups
BACKUP_KEEP=10
ENABLE_HEALTH=0
HEALTH_HOST=0.0.0.0
HEALTH_PORT=8080
ENABLE_METRICS=0
METRICS_PORT=8000
SHUTDOWN_TIMEOUT=30
RETRY_ATTEMPTS=3
RETRY_DELAY=1.0
RETRY_MAX_DELAY=8.0
RETRY_BACKOFF=2.0
PYTHONUNBUFFERED=1
ENABLE_POLLING=1
ENABLE_SCHEDULER=1
STARTUP_DELAY_SEC=0.0
FAILSAFE_MODE=0
PAGINATION_PAGE_SIZE=5
CACHE_TTL_SECONDS=120
ADMIN_IDS=
DIGEST_DEFAULT_TIME=09:00
PROMETHEUS__ENABLED=true
PROMETHEUS__ENDPOINT=/metrics
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
SENTRY__ENABLED=false
SENTRY__DSN=
SENTRY__ENVIRONMENT=local
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=60
RATE_LIMIT_PER_SECONDS=60

# Diagnostics & quality gates
GOLDEN_COEF_EPS=0.005
GOLDEN_LAMBDA_MAPE=0.015
GOLDEN_PROB_EPS=0.005
DRIFT_REF_DAYS=90
DRIFT_ROLLING_DAYS=30
DRIFT_PSI_WARN=0.1
DRIFT_PSI_FAIL=0.25
DRIFT_KS_P_WARN=0.05
DRIFT_KS_P_FAIL=0.01
BENCH_P95_BUDGET_MS=800
BENCH_ITER=30
DIAG_SCHEDULE_CRON="0 6 * * *"
DIAG_ON_START=1
DIAG_MAX_RUNTIME_MIN=25
REPORTS_IMG_FORMAT=svg
DIAG_HISTORY_KEEP=60
ALERTS_ENABLED=1
ALERTS_CHAT_ID=
ALERTS_MIN_LEVEL=WARN
AUTO_REF_UPDATE=off
SHOW_DATA_STALENESS=1
# Пороги для `python -m diagtools.freshness --check` и бейджей бота
SM_FRESHNESS_WARN_HOURS=12
SM_FRESHNESS_FAIL_HOURS=48

# ML / Retrain
RETRAIN_CRON=""
SEASON_ID=23855  # default season for training script
SIM_RHO=0.1
SIM_N=10000
SIM_CHUNK=100000

# Services/Workers
# prediction pipeline и планировщик будут читать эти значения при инициализации
# (см. services/prediction_pipeline.py, workers/retrain_scheduler.py)
